{"ast":null,"code":"import _asyncToGenerator from \"D:\\\\daima\\\\\\u9879\\u76EE\\\\zhongchou\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"D:\\\\daima\\\\\\u9879\\u76EE\\\\zhongchou\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"D:\\\\daima\\\\\\u9879\\u76EE\\\\zhongchou\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"D:\\\\daima\\\\\\u9879\\u76EE\\\\zhongchou\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"D:\\\\daima\\\\\\u9879\\u76EE\\\\zhongchou\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"D:\\\\daima\\\\\\u9879\\u76EE\\\\zhongchou\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"D:\\\\daima\\\\\\u9879\\u76EE\\\\zhongchou\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"D:\\\\daima\\\\\\u9879\\u76EE\\\\zhongchou\\\\src\\\\display\\\\indexP.js\";\nfunction _regeneratorRuntime() { \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ _regeneratorRuntime = function _regeneratorRuntime() { return exports; }; var exports = {}, Op = Object.prototype, hasOwn = Op.hasOwnProperty, $Symbol = \"function\" == typeof Symbol ? Symbol : {}, iteratorSymbol = $Symbol.iterator || \"@@iterator\", asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\", toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\"; function define(obj, key, value) { return Object.defineProperty(obj, key, { value: value, enumerable: !0, configurable: !0, writable: !0 }), obj[key]; } try { define({}, \"\"); } catch (err) { define = function define(obj, key, value) { return obj[key] = value; }; } function wrap(innerFn, outerFn, self, tryLocsList) { var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator, generator = Object.create(protoGenerator.prototype), context = new Context(tryLocsList || []); return generator._invoke = function (innerFn, self, context) { var state = \"suspendedStart\"; return function (method, arg) { if (\"executing\" === state) throw new Error(\"Generator is already running\"); if (\"completed\" === state) { if (\"throw\" === method) throw arg; return doneResult(); } for (context.method = method, context.arg = arg;;) { var delegate = context.delegate; if (delegate) { var delegateResult = maybeInvokeDelegate(delegate, context); if (delegateResult) { if (delegateResult === ContinueSentinel) continue; return delegateResult; } } if (\"next\" === context.method) context.sent = context._sent = context.arg;else if (\"throw\" === context.method) { if (\"suspendedStart\" === state) throw state = \"completed\", context.arg; context.dispatchException(context.arg); } else \"return\" === context.method && context.abrupt(\"return\", context.arg); state = \"executing\"; var record = tryCatch(innerFn, self, context); if (\"normal\" === record.type) { if (state = context.done ? \"completed\" : \"suspendedYield\", record.arg === ContinueSentinel) continue; return { value: record.arg, done: context.done }; } \"throw\" === record.type && (state = \"completed\", context.method = \"throw\", context.arg = record.arg); } }; }(innerFn, self, context), generator; } function tryCatch(fn, obj, arg) { try { return { type: \"normal\", arg: fn.call(obj, arg) }; } catch (err) { return { type: \"throw\", arg: err }; } } exports.wrap = wrap; var ContinueSentinel = {}; function Generator() {} function GeneratorFunction() {} function GeneratorFunctionPrototype() {} var IteratorPrototype = {}; define(IteratorPrototype, iteratorSymbol, function () { return this; }); var getProto = Object.getPrototypeOf, NativeIteratorPrototype = getProto && getProto(getProto(values([]))); NativeIteratorPrototype && NativeIteratorPrototype !== Op && hasOwn.call(NativeIteratorPrototype, iteratorSymbol) && (IteratorPrototype = NativeIteratorPrototype); var Gp = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(IteratorPrototype); function defineIteratorMethods(prototype) { [\"next\", \"throw\", \"return\"].forEach(function (method) { define(prototype, method, function (arg) { return this._invoke(method, arg); }); }); } function AsyncIterator(generator, PromiseImpl) { function invoke(method, arg, resolve, reject) { var record = tryCatch(generator[method], generator, arg); if (\"throw\" !== record.type) { var result = record.arg, value = result.value; return value && \"object\" == typeof value && hasOwn.call(value, \"__await\") ? PromiseImpl.resolve(value.__await).then(function (value) { invoke(\"next\", value, resolve, reject); }, function (err) { invoke(\"throw\", err, resolve, reject); }) : PromiseImpl.resolve(value).then(function (unwrapped) { result.value = unwrapped, resolve(result); }, function (error) { return invoke(\"throw\", error, resolve, reject); }); } reject(record.arg); } var previousPromise; this._invoke = function (method, arg) { function callInvokeWithMethodAndArg() { return new PromiseImpl(function (resolve, reject) { invoke(method, arg, resolve, reject); }); } return previousPromise = previousPromise ? previousPromise.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg(); }; } function maybeInvokeDelegate(delegate, context) { var method = delegate.iterator[context.method]; if (undefined === method) { if (context.delegate = null, \"throw\" === context.method) { if (delegate.iterator.return && (context.method = \"return\", context.arg = undefined, maybeInvokeDelegate(delegate, context), \"throw\" === context.method)) return ContinueSentinel; context.method = \"throw\", context.arg = new TypeError(\"The iterator does not provide a 'throw' method\"); } return ContinueSentinel; } var record = tryCatch(method, delegate.iterator, context.arg); if (\"throw\" === record.type) return context.method = \"throw\", context.arg = record.arg, context.delegate = null, ContinueSentinel; var info = record.arg; return info ? info.done ? (context[delegate.resultName] = info.value, context.next = delegate.nextLoc, \"return\" !== context.method && (context.method = \"next\", context.arg = undefined), context.delegate = null, ContinueSentinel) : info : (context.method = \"throw\", context.arg = new TypeError(\"iterator result is not an object\"), context.delegate = null, ContinueSentinel); } function pushTryEntry(locs) { var entry = { tryLoc: locs[0] }; 1 in locs && (entry.catchLoc = locs[1]), 2 in locs && (entry.finallyLoc = locs[2], entry.afterLoc = locs[3]), this.tryEntries.push(entry); } function resetTryEntry(entry) { var record = entry.completion || {}; record.type = \"normal\", delete record.arg, entry.completion = record; } function Context(tryLocsList) { this.tryEntries = [{ tryLoc: \"root\" }], tryLocsList.forEach(pushTryEntry, this), this.reset(!0); } function values(iterable) { if (iterable) { var iteratorMethod = iterable[iteratorSymbol]; if (iteratorMethod) return iteratorMethod.call(iterable); if (\"function\" == typeof iterable.next) return iterable; if (!isNaN(iterable.length)) { var i = -1, next = function next() { for (; ++i < iterable.length;) { if (hasOwn.call(iterable, i)) return next.value = iterable[i], next.done = !1, next; } return next.value = undefined, next.done = !0, next; }; return next.next = next; } } return { next: doneResult }; } function doneResult() { return { value: undefined, done: !0 }; } return GeneratorFunction.prototype = GeneratorFunctionPrototype, define(Gp, \"constructor\", GeneratorFunctionPrototype), define(GeneratorFunctionPrototype, \"constructor\", GeneratorFunction), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, toStringTagSymbol, \"GeneratorFunction\"), exports.isGeneratorFunction = function (genFun) { var ctor = \"function\" == typeof genFun && genFun.constructor; return !!ctor && (ctor === GeneratorFunction || \"GeneratorFunction\" === (ctor.displayName || ctor.name)); }, exports.mark = function (genFun) { return Object.setPrototypeOf ? Object.setPrototypeOf(genFun, GeneratorFunctionPrototype) : (genFun.__proto__ = GeneratorFunctionPrototype, define(genFun, toStringTagSymbol, \"GeneratorFunction\")), genFun.prototype = Object.create(Gp), genFun; }, exports.awrap = function (arg) { return { __await: arg }; }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, asyncIteratorSymbol, function () { return this; }), exports.AsyncIterator = AsyncIterator, exports.async = function (innerFn, outerFn, self, tryLocsList, PromiseImpl) { void 0 === PromiseImpl && (PromiseImpl = Promise); var iter = new AsyncIterator(wrap(innerFn, outerFn, self, tryLocsList), PromiseImpl); return exports.isGeneratorFunction(outerFn) ? iter : iter.next().then(function (result) { return result.done ? result.value : iter.next(); }); }, defineIteratorMethods(Gp), define(Gp, toStringTagSymbol, \"Generator\"), define(Gp, iteratorSymbol, function () { return this; }), define(Gp, \"toString\", function () { return \"[object Generator]\"; }), exports.keys = function (object) { var keys = []; for (var key in object) { keys.push(key); } return keys.reverse(), function next() { for (; keys.length;) { var key = keys.pop(); if (key in object) return next.value = key, next.done = !1, next; } return next.done = !0, next; }; }, exports.values = values, Context.prototype = { constructor: Context, reset: function reset(skipTempReset) { if (this.prev = 0, this.next = 0, this.sent = this._sent = undefined, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = undefined, this.tryEntries.forEach(resetTryEntry), !skipTempReset) for (var name in this) { \"t\" === name.charAt(0) && hasOwn.call(this, name) && !isNaN(+name.slice(1)) && (this[name] = undefined); } }, stop: function stop() { this.done = !0; var rootRecord = this.tryEntries[0].completion; if (\"throw\" === rootRecord.type) throw rootRecord.arg; return this.rval; }, dispatchException: function dispatchException(exception) { if (this.done) throw exception; var context = this; function handle(loc, caught) { return record.type = \"throw\", record.arg = exception, context.next = loc, caught && (context.method = \"next\", context.arg = undefined), !!caught; } for (var i = this.tryEntries.length - 1; i >= 0; --i) { var entry = this.tryEntries[i], record = entry.completion; if (\"root\" === entry.tryLoc) return handle(\"end\"); if (entry.tryLoc <= this.prev) { var hasCatch = hasOwn.call(entry, \"catchLoc\"), hasFinally = hasOwn.call(entry, \"finallyLoc\"); if (hasCatch && hasFinally) { if (this.prev < entry.catchLoc) return handle(entry.catchLoc, !0); if (this.prev < entry.finallyLoc) return handle(entry.finallyLoc); } else if (hasCatch) { if (this.prev < entry.catchLoc) return handle(entry.catchLoc, !0); } else { if (!hasFinally) throw new Error(\"try statement without catch or finally\"); if (this.prev < entry.finallyLoc) return handle(entry.finallyLoc); } } } }, abrupt: function abrupt(type, arg) { for (var i = this.tryEntries.length - 1; i >= 0; --i) { var entry = this.tryEntries[i]; if (entry.tryLoc <= this.prev && hasOwn.call(entry, \"finallyLoc\") && this.prev < entry.finallyLoc) { var finallyEntry = entry; break; } } finallyEntry && (\"break\" === type || \"continue\" === type) && finallyEntry.tryLoc <= arg && arg <= finallyEntry.finallyLoc && (finallyEntry = null); var record = finallyEntry ? finallyEntry.completion : {}; return record.type = type, record.arg = arg, finallyEntry ? (this.method = \"next\", this.next = finallyEntry.finallyLoc, ContinueSentinel) : this.complete(record); }, complete: function complete(record, afterLoc) { if (\"throw\" === record.type) throw record.arg; return \"break\" === record.type || \"continue\" === record.type ? this.next = record.arg : \"return\" === record.type ? (this.rval = this.arg = record.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === record.type && afterLoc && (this.next = afterLoc), ContinueSentinel; }, finish: function finish(finallyLoc) { for (var i = this.tryEntries.length - 1; i >= 0; --i) { var entry = this.tryEntries[i]; if (entry.finallyLoc === finallyLoc) return this.complete(entry.completion, entry.afterLoc), resetTryEntry(entry), ContinueSentinel; } }, catch: function _catch(tryLoc) { for (var i = this.tryEntries.length - 1; i >= 0; --i) { var entry = this.tryEntries[i]; if (entry.tryLoc === tryLoc) { var record = entry.completion; if (\"throw\" === record.type) { var thrown = record.arg; resetTryEntry(entry); } return thrown; } } throw new Error(\"illegal catch attempt\"); }, delegateYield: function delegateYield(iterable, resultName, nextLoc) { return this.delegate = { iterator: values(iterable), resultName: resultName, nextLoc: nextLoc }, \"next\" === this.method && (this.arg = undefined), ContinueSentinel; } }, exports; }\nimport React, { Component } from 'react';\nimport MyThs from \"./myThs\";\nimport ReactDOM from 'react-dom';\nimport Reg from \"./reg\";\nvar web3 = require('../utils/initWeb3');\nvar _require = require('../eth/lotteryInstance'),\n  votingFactoryContractInstance = _require.votingFactoryContractInstance,\n  votingABI = _require.votingABI;\nconsole.log(votingFactoryContractInstance.methods);\n\n// string _voteTitle,输入\n// uint _creatTime,系统初始化\n// uint _limitVoter,输入\n// string _voteExplain,输入\n// uint _q,uint _g,系统初始化\n// string[] _voteOptions,输入（数组）\n// uint _luckyReward，输入\nvar IndexP = /*#__PURE__*/function (_Component) {\n  _inherits(IndexP, _Component);\n  function IndexP(props) {\n    var _this;\n    _classCallCheck(this, IndexP);\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(IndexP).call(this, props));\n    _this.handleClick = function (index) {\n      console.log(index);\n      ReactDOM.render( /*#__PURE__*/React.createElement(Reg, {\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 91,\n          columnNumber: 25\n        }\n      }), document.getElementById('root'));\n    };\n    _this.state = {\n      list: []\n    };\n    return _this;\n  }\n\n  //内置钩子函数，在页面渲染之后自动调用\n  _createClass(IndexP, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {} //内置钩子函数，在页面渲染之前调用\n  }, {\n    key: \"componentWillMount\",\n    value: function () {\n      var _componentWillMount = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n        var voteAllAddress, detailsPromises;\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.next = 2;\n                return votingFactoryContractInstance.methods.getAllVotings().call();\n              case 2:\n                voteAllAddress = _context2.sent;\n                detailsPromises = voteAllAddress.map(function (voteAddress) {\n                  return new Promise( /*#__PURE__*/function () {\n                    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(resolve, reject) {\n                      var newVotingContractInstance, title, voteExplain, manager, creatTime, starTime, endTime, state, detail;\n                      return _regeneratorRuntime().wrap(function _callee$(_context) {\n                        while (1) {\n                          switch (_context.prev = _context.next) {\n                            case 0:\n                              _context.prev = 0;\n                              newVotingContractInstance = new web3.eth.Contract(votingABI);\n                              newVotingContractInstance.options.address = voteAddress;\n                              //调用方法，返回funding合约的详情\n                              _context.next = 5;\n                              return newVotingContractInstance.methods.voteTitle().call();\n                            case 5:\n                              title = _context.sent;\n                              _context.next = 8;\n                              return newVotingContractInstance.methods.voteExplain().call();\n                            case 8:\n                              voteExplain = _context.sent;\n                              _context.next = 11;\n                              return newVotingContractInstance.methods.manager().call();\n                            case 11:\n                              manager = _context.sent;\n                              _context.next = 14;\n                              return newVotingContractInstance.methods.creatTime().call();\n                            case 14:\n                              creatTime = _context.sent;\n                              _context.next = 17;\n                              return newVotingContractInstance.methods.starTime().call();\n                            case 17:\n                              starTime = _context.sent;\n                              _context.next = 20;\n                              return newVotingContractInstance.methods.endTime().call();\n                            case 20:\n                              endTime = _context.sent;\n                              state = '未知错误！';\n                              if (starTime === '') {\n                                state = '注册阶段';\n                              } else if (starTime !== '' && endTime === '') {\n                                state = '投票阶段';\n                              } else if (endTime !== '') {\n                                state = '结束阶段';\n                              }\n                              detail = {\n                                title: title,\n                                voteExplain: voteExplain,\n                                manager: manager,\n                                creatTime: creatTime,\n                                state: state\n                              };\n                              resolve(detail);\n                              _context.next = 30;\n                              break;\n                            case 27:\n                              _context.prev = 27;\n                              _context.t0 = _context[\"catch\"](0);\n                              reject(_context.t0);\n                            case 30:\n                            case \"end\":\n                              return _context.stop();\n                          }\n                        }\n                      }, _callee, null, [[0, 27]]);\n                    }));\n                    return function (_x, _x2) {\n                      return _ref.apply(this, arguments);\n                    };\n                  }());\n                });\n                _context2.t0 = this;\n                _context2.next = 7;\n                return Promise.all(detailsPromises);\n              case 7:\n                _context2.t1 = _context2.sent;\n                _context2.t2 = {\n                  list: _context2.t1\n                };\n                _context2.t0.setState.call(_context2.t0, _context2.t2);\n              case 10:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n      function componentWillMount() {\n        return _componentWillMount.apply(this, arguments);\n      }\n      return componentWillMount;\n    }() //卸载钩子函数\n    // componentDidMount\n    // jianTing = () => {\n    //     window.ethereum.on(\"accountsChanged\", function(accounts) {\n    //         window.location.reload()\n    //     });\n    // }\n    //参与就是注册\n  }, {\n    key: \"render\",\n    value: function render() {\n      var numP = 1;\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"row\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 97,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"sixteen wide column\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 98,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"ui segments\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 99,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"ui segment\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 100,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(\"h5\", {\n        className: \"ui header\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 29\n        }\n      }, \"\\u6240\\u6709\\u6295\\u7968\\u5217\\u8868\")), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"ui segment\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 105,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(\"table\", {\n        id: \"data_table\",\n        className: \"ui compact selectable striped celled table tablet stackable\",\n        cellSpacing: \"0\",\n        width: \"100%\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 106,\n          columnNumber: 29\n        }\n      }, /*#__PURE__*/React.createElement(\"thead\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 107,\n          columnNumber: 33\n        }\n      }, /*#__PURE__*/React.createElement(\"tr\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 108,\n          columnNumber: 33\n        }\n      }, /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 109,\n          columnNumber: 37\n        }\n      }, \"Title\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 110,\n          columnNumber: 37\n        }\n      }, \"Brief introduction\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 111,\n          columnNumber: 37\n        }\n      }, \"Creater address\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 112,\n          columnNumber: 37\n        }\n      }, \"Creat time\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 37\n        }\n      }, \"State\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 114,\n          columnNumber: 37\n        }\n      }, \"Operation\"))), /*#__PURE__*/React.createElement(\"tbody\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 117,\n          columnNumber: 33\n        }\n      }, /*#__PURE__*/React.createElement(\"tr\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 118,\n          columnNumber: 33\n        }\n      }, /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 119,\n          columnNumber: 37\n        }\n      }), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 120,\n          columnNumber: 37\n        }\n      }), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 37\n        }\n      }), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 122,\n          columnNumber: 37\n        }\n      }), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 123,\n          columnNumber: 37\n        }\n      }), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 124,\n          columnNumber: 37\n        }\n      }))), /*#__PURE__*/React.createElement(MyThs, {\n        details: this.state.list,\n        numP: numP,\n        handleClick: this.handleClick(),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 128,\n          columnNumber: 33\n        }\n      }))))));\n    }\n  }]);\n  return IndexP;\n}(Component);\nexport default IndexP;","map":{"version":3,"names":["React","Component","MyThs","ReactDOM","Reg","web3","require","votingFactoryContractInstance","votingABI","console","log","methods","IndexP","props","handleClick","index","render","document","getElementById","state","list","getAllVotings","call","voteAllAddress","detailsPromises","map","voteAddress","Promise","resolve","reject","newVotingContractInstance","eth","Contract","options","address","voteTitle","title","voteExplain","manager","creatTime","starTime","endTime","detail","all","setState","numP"],"sources":["D:/daima/项目/zhongchou/src/display/indexP.js"],"sourcesContent":["import React, {Component} from 'react';\nimport MyThs from \"./myThs\";\nimport ReactDOM from 'react-dom';\nimport Reg from \"./reg\";\n\n\nlet web3 = require('../utils/initWeb3')\nlet {votingFactoryContractInstance, votingABI} = require('../eth/lotteryInstance')\n\nconsole.log(votingFactoryContractInstance.methods)\n\n// string _voteTitle,输入\n// uint _creatTime,系统初始化\n// uint _limitVoter,输入\n// string _voteExplain,输入\n// uint _q,uint _g,系统初始化\n// string[] _voteOptions,输入（数组）\n// uint _luckyReward，输入\n\nclass IndexP extends Component {\n    constructor(props) {\n        super(props)\n        this.state = {\n            list: []\n        }\n\n    }\n\n    //内置钩子函数，在页面渲染之后自动调用\n    componentDidMount() {\n\n    }\n\n\n\n    //内置钩子函数，在页面渲染之前调用\n    async componentWillMount() {\n        //获取当前的所有地址\n        let voteAllAddress = await votingFactoryContractInstance.methods.getAllVotings().call()\n\n\n\n        let detailsPromises = voteAllAddress.map(function (voteAddress){\n\n            return new Promise(async(resolve, reject) => {\n                //对实例进行填充地址，可以使用了let votingContractInstance = new web3.eth.Contract(VotingABI)\n                try {\n                    let newVotingContractInstance = new web3.eth.Contract(votingABI);\n                    newVotingContractInstance.options.address = voteAddress\n                    //调用方法，返回funding合约的详情\n                    let title = await newVotingContractInstance.methods.voteTitle().call()\n                    let voteExplain = await newVotingContractInstance.methods.voteExplain().call()\n                    let manager = await newVotingContractInstance.methods.manager().call()\n                    let creatTime = await newVotingContractInstance.methods.creatTime().call()\n\n                    let starTime = await newVotingContractInstance.methods.starTime().call()\n                    let endTime = await newVotingContractInstance.methods.endTime().call()\n                    let state = '未知错误！'\n                    if(starTime === ''){\n                        state = '注册阶段'\n                    }else if(starTime !== '' && endTime === ''){\n                        state = '投票阶段'\n                    }else if(endTime !== ''){\n                        state = '结束阶段'\n                    }\n                    let detail = {title,voteExplain,manager,creatTime,state}\n                    resolve (detail)\n                }catch (e){\n                    reject(e)\n                }\n            })\n\n        })\n\n        this.setState({\n            list: await Promise.all(detailsPromises)\n        })\n    }\n\n    //卸载钩子函数\n    // componentDidMount\n\n    // jianTing = () => {\n    //     window.ethereum.on(\"accountsChanged\", function(accounts) {\n    //         window.location.reload()\n    //     });\n    // }\n    //参与就是注册\n    handleClick = (index) => {\n        console.log(index)\n        ReactDOM.render(<Reg />, document.getElementById('root'));\n    }\n\n    render() {\n        let numP = 1\n        return (\n            <div className=\"row\">\n                <div className=\"sixteen wide column\">\n                    <div className=\"ui segments\">\n                        <div className=\"ui segment\">\n                            <h5 className=\"ui header\">\n                                所有投票列表\n                            </h5>\n                        </div>\n                        <div className=\"ui segment\">\n                            <table id=\"data_table\" className=\"ui compact selectable striped celled table tablet stackable\" cellSpacing=\"0\" width=\"100%\">\n                                <thead>\n                                <tr>\n                                    <th>Title</th>\n                                    <th>Brief introduction</th>\n                                    <th>Creater address</th>\n                                    <th>Creat time</th>\n                                    <th>State</th>\n                                    <th>Operation</th>\n                                </tr>\n                                </thead>\n                                <tbody>\n                                <tr>\n                                    <td></td>\n                                    <td></td>\n                                    <td></td>\n                                    <td></td>\n                                    <td></td>\n                                    <td></td>\n                                </tr>\n                                </tbody>\n\n                                <MyThs\n                                    details = {this.state.list}\n                                    numP = {numP}\n                                    handleClick = {this.handleClick()}\n                                />\n                            </table>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default IndexP;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}